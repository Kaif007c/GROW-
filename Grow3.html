<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grow - Workforce Performance Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .sidebar-item.active {
            background-color: #e0f2fe;
            border-right: 3px solid #2563eb;
            color: #2563eb;
        }
        .performance-0-20 { background-color: #fecaca; }
        .performance-21-60 { background-color: #fef3c7; }
        .performance-61-80 { background-color: #bbf7d0; }
        .performance-81-100 { background-color: #86efac; }
        .fade-in { animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        .toast.success { background-color: #10b981; }
        .toast.error { background-color: #ef4444; }
        .toast.info { background-color: #3b82f6; }
        
        .dark-mode {
            background-color: #1f2937;
            color: #f9fafb;
        }
        .dark-mode .bg-white {
            background-color: #374151;
        }
        .dark-mode .text-gray-800, 
        .dark-mode .text-gray-900 {
            color: #f9fafb;
        }
        .dark-mode .text-gray-600,
        .dark-mode .text-gray-500 {
            color: #d1d5db;
        }
        .dark-mode .bg-gray-50 {
            background-color: #4b5563;
        }
        .dark-mode .divide-gray-200 > * + * {
            border-color: #6b7280;
        }
        .dark-mode .shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        .kpi-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .attendance-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .attendance-present {
            background-color: #dcfce7;
            color: #166534;
        }
        .attendance-absent {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .training-modal {
            max-width: 800px;
            width: 90%;
        }
        
        .gradient-line {
            background: linear-gradient(90deg, rgba(34,197,94,0.2) 0%, rgba(34,197,94,0) 100%);
        }
        
        .action-needed {
            position: relative;
        }
        .action-needed::after {
            content: "⚠️";
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 1.2rem;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                bottom: 0;
                width: 250px;
                z-index: 40;
                transition: left 0.3s ease;
            }
            .sidebar.open {
                left: 0;
            }
            .mobile-menu-btn {
                display: block;
            }
            .header-content {
                flex-wrap: wrap;
            }
            .search-container {
                order: 3;
                width: 100%;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Toast Notifications -->
    <div id="toastContainer"></div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-lg w-96">
            <div class="flex items-center justify-center mb-6">
                <svg class="w-10 h-10 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                </svg>
                <h2 class="text-2xl font-bold text-gray-800">Grow Dashboard</h2>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="username">Username</label>
                <input id="username" type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Username">
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="password">Password</label>
                <input id="password" type="password" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Password">
            </div>
            <div class="flex items-center justify-between">
                <button id="loginBtn" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full">Sign In</button>
            </div>
            <p class="text-center text-gray-500 text-xs mt-4">Use: admin / admin</p>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow">
            <div class="flex justify-between items-center px-6 py-4 header-content">
                <div class="flex items-center">
                    <button id="mobileMenuBtn" class="mobile-menu-btn mr-2 md:hidden">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <svg class="w-8 h-8 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                    </svg>
                    <h1 class="text-xl font-bold text-gray-800">Grow - Workforce Performance Dashboard</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative search-container">
                        <input type="text" id="searchInput" placeholder="Search employees..." class="pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent w-full">
                        <svg class="w-5 h-5 absolute left-3 top-2.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <button id="darkModeToggle" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300">
                        <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                    <button id="exportBtn" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                        Export Data
                    </button>
                    <button id="clearAllBtn" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                        Clear All
                    </button>
                </div>
            </div>
        </header>

        <div class="flex h-screen">
            <!-- Sidebar -->
            <div class="w-64 bg-white shadow-md sidebar">
                <nav class="mt-5 px-2">
                    <a href="#" class="sidebar-item group flex items-center px-2 py-2 text-base font-medium rounded-md active" data-section="dashboard">
                        <svg class="mr-4 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                        </svg>
                        Dashboard
                    </a>
                    <a href="#" class="sidebar-item group flex items-center px-2 py-2 text-base font-medium rounded-md" data-section="employees">
                        <svg class="mr-4 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                        Employees
                    </a>
                    <a href="#" class="sidebar-item group flex items-center px-2 py-2 text-base font-medium rounded-md" data-section="sectors">
                        <svg class="mr-4 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                        </svg>
                        Sectors
                    </a>
                    <a href="#" class="sidebar-item group flex items-center px-2 py-2 text-base font-medium rounded-md" data-section="performance">
                        <svg class="mr-4 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                        Performance
                    </a>
                    <a href="#" class="sidebar-item group flex items-center px-2 py-2 text-base font-medium rounded-md" data-section="strength">
                        <svg class="mr-4 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        Company Strength
                    </a>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="flex-1 overflow-auto p-6">
                <!-- Dashboard Section -->
                <div id="dashboard-section" class="fade-in">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Dashboard Overview</h2>
                    
                    <!-- KPI Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="kpi-card bg-white rounded-lg shadow p-6 transition-transform duration-300" data-section="employees">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-blue-100 text-blue-500">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600">Total Employees</p>
                                    <h3 id="totalEmployees" class="text-2xl font-bold text-gray-900">0</h3>
                                </div>
                            </div>
                        </div>
                        
                        <div class="kpi-card bg-white rounded-lg shadow p-6 transition-transform duration-300" data-section="performance">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-green-100 text-green-500">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600">Avg. Performance</p>
                                    <h3 id="avgPerformance" class="text-2xl font-bold text-gray-900">0%</h3>
                                </div>
                            </div>
                        </div>
                        
                        <div class="kpi-card bg-white rounded-lg shadow p-6 transition-transform duration-300" data-section="skill-utilization">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-purple-100 text-purple-500">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600">Skill Utilization</p>
                                    <h3 id="skillUtilization" class="text-2xl font-bold text-gray-900">0%</h3>
                                </div>
                            </div>
                        </div>
                        
                        <div class="kpi-card bg-white rounded-lg shadow p-6 transition-transform duration-300 action-needed" id="trainingNeededCard">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-yellow-100 text-yellow-500">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                                    </svg>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600">Training Needed</p>
                                    <h3 id="trainingNeeded" class="text-2xl font-bold text-gray-900">0</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6 transition-transform duration-300 hover:scale-[1.01]">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Sector-wise Performance</h3>
                            <div class="h-80">
                                <canvas id="sectorPerformanceChart"></canvas>
                            </div>
                            <p id="sectorPerformanceSummary" class="text-sm text-gray-600 mt-4"></p>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6 transition-transform duration-300 hover:scale-[1.01]">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Real-time Productivity Trend</h3>
                            <div class="h-80">
                                <canvas id="productivityTrendChart"></canvas>
                            </div>
                            <p id="productivityTrendSummary" class="text-sm text-gray-600 mt-4"></p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6 transition-transform duration-300 hover:scale-[1.01]">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Skill Distribution</h3>
                        <div class="h-80">
                            <canvas id="skillDistributionChart"></canvas>
                        </div>
                        <p id="skillDistributionSummary" class="text-sm text-gray-600 mt-4"></p>
                    </div>
                </div>
                
                <!-- Employees Section -->
                <div id="employees-section" class="hidden fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Employee Management</h2>
                        <button id="addEmployeeBtn" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                            Add Employee
                        </button>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow overflow-hidden mb-6">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sector</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Consistency</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Efficiency</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quality</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Performance</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="employeesTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Employee rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Attendance Input Section -->
                    <div class="bg-white rounded-lg shadow p-6 mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Daily Attendance Input</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Employee</label>
                                <select id="attendanceEmployee" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="">Select Employee</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                                <input type="date" id="attendanceDate" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                <select id="attendanceStatus" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="Present">Present</option>
                                    <option value="Absent">Absent</option>
                                </select>
                            </div>
                        </div>
                        <button id="recordAttendanceBtn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                            Record Attendance
                        </button>
                    </div>
                    
                    <!-- Recent Attendance Records -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Recent Attendance Records</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="attendanceTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Attendance records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Sectors Section -->
                <div id="sectors-section" class="hidden fade-in">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Sector Performance</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" id="sectorBoxesContainer">
                        <!-- Sector boxes will be populated here -->
                    </div>
                    
                    <div id="sector-detail" class="hidden">
                        <div class="bg-white rounded-lg shadow p-6 mb-6">
                            <h3 id="sectorDetailTitle" class="text-xl font-bold text-gray-800 mb-4"></h3>
                            <p id="sectorSummary" class="text-gray-600 mb-6"></p>
                            
                            <div class="h-80 mb-6">
                                <canvas id="sectorDetailChart"></canvas>
                            </div>
                            
                            <h4 class="text-lg font-medium text-gray-900 mb-4">Employees in this Sector</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Consistency</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Efficiency</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quality</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Performance</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sectorEmployeesTableBody" class="bg-white divide-y divide-gray-200">
                                        <!-- Sector employee rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Section -->
                <div id="performance-section" class="hidden fade-in">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Performance Analytics</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Performance Distribution</h3>
                            <div class="h-80">
                                <canvas id="performanceDistributionChart"></canvas>
                            </div>
                            <p id="performanceDistributionSummary" class="text-sm text-gray-600 mt-4"></p>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Attendance vs Performance</h3>
                            <div class="h-80">
                                <canvas id="attendancePerformanceChart"></canvas>
                            </div>
                            <p id="attendancePerformanceSummary" class="text-sm text-gray-600 mt-4"></p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Performance Trends Over Time</h3>
                        <div class="h-80">
                            <canvas id="performanceTrendsChart"></canvas>
                        </div>
                        <p id="performanceTrendsSummary" class="text-sm text-gray-600 mt-4"></p>
                    </div>
                </div>
                
                <!-- Strength Section -->
                <div id="strength-section" class="hidden fade-in">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Company Strength</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4 text-center">Most Consistent</h3>
                            <div class="text-center">
                                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 text-blue-500 mb-4">
                                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <h4 id="mostConsistent" class="text-xl font-bold text-gray-900">-</h4>
                                <p id="mostConsistentValue" class="text-gray-600">0%</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4 text-center">Most Efficient</h3>
                            <div class="text-center">
                                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 text-green-500 mb-4">
                                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                                <h4 id="mostEfficient" class="text-xl font-bold text-gray-900">-</h4>
                                <p id="mostEfficientValue" class="text-gray-600">0%</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4 text-center">Highest Quality</h3>
                            <div class="text-center">
                                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-purple-100 text-purple-500 mb-4">
                                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                    </svg>
                                </div>
                                <h4 id="highestQuality" class="text-xl font-bold text-gray-900">-</h4>
                                <p id="highestQualityValue" class="text-gray-600">0%</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4 text-center">Top Overall</h3>
                            <div class="text-center">
                                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-yellow-100 text-yellow-500 mb-4">
                                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                                    </svg>
                                </div>
                                <h4 id="topOverall" class="text-xl font-bold text-gray-900">-</h4>
                                <p id="topOverallValue" class="text-gray-600">0%</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Strengths & Weaknesses Analysis</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="text-md font-medium text-gray-900 mb-2">Strengths</h4>
                                <ul id="strengthsList" class="list-disc pl-5 text-gray-600">
                                    <!-- Strengths will be populated here -->
                                </ul>
                            </div>
                            <div>
                                <h4 class="text-md font-medium text-gray-900 mb-2">Areas for Improvement</h4>
                                <ul id="weaknessesList" class="list-disc pl-5 text-gray-600">
                                    <!-- Weaknesses will be populated here -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div id="employeeModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Add New Employee</h2>j
            <form id="employeeForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="employeeName">Name</label>
                    <input type="text" id="employeeName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="employeeSector">Sector</label>
                    <select id="employeeSector" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <option value="">Select Sector</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales</option>
                        
                        <option value="Finance">Finance</option>
                        <option value="Operations">Operations</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="workedHours">Worked Hours</label>
                    <input type="number" id="workedHours" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" min="0" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="totalProjectHours">Total Project Hours</label>
                    <input type="number" id="totalProjectHours" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" min="0" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="projectCompleted">Project Completed</label>
                    <select id="projectCompleted" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="flex items-center justify-between">
                    <button type="button" id="cancelEmployeeBtn" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Cancel
                    </button>
                    <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Save Employee
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Training Needed Modal -->
    <div id="trainingModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg training-modal max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Employees Needing Training</h2>
                    <button id="closeTrainingModal" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="trainingList" class="mb-6">
                    <!-- Training list will be populated here -->
                </div>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <span class="font-medium">Recommendation:</span> Consider implementing targeted training programs for employees with performance below 60%. Focus on skill development in their specific areas of weakness.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end">
                    <button id="closeTrainingModalBtn" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Skill Utilization Modal -->
    <div id="skillUtilizationModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Skill Utilization Analysis</h2>
                    <button id="closeSkillModal" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white rounded-lg shadow p-4">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Efficiency Distribution</h3>
                        <div class="h-64">
                            <canvas id="efficiencyDistributionChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-4">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Skill Utilization by Sector</h3>
                        <div class="h-64">
                            <canvas id="sectorEfficiencyChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow p-4 mb-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Recommendations</h3>
                    <div id="skillRecommendations" class="text-gray-600">
                        <!-- Recommendations will be populated here -->
                    </div>
                </div>
                <div class="flex justify-end">
                    <button id="closeSkillModalBtn" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dashboard State Management
        const dashboardState = {
            employees: [],
            attendance: [],
            sectors: ['Engineering', 'Marketing', 'Sales', 'HR', 'Finance', 'Operations'],
            charts: {},
            darkMode: false
        };

        // DOM Elements
        const loginModal = document.getElementById('loginModal');
        const dashboard = document.getElementById('dashboard');
        const loginBtn = document.getElementById('loginBtn');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        const sections = document.querySelectorAll('[id$="-section"]');
        const addEmployeeBtn = document.getElementById('addEmployeeBtn');
        const employeeModal = document.getElementById('employeeModal');
        const employeeForm = document.getElementById('employeeForm');
        const cancelEmployeeBtn = document.getElementById('cancelEmployeeBtn');
        const employeesTableBody = document.getElementById('employeesTableBody');
        const attendanceEmployee = document.getElementById('attendanceEmployee');
        const attendanceDate = document.getElementById('attendanceDate');
        const attendanceStatus = document.getElementById('attendanceStatus');
        const recordAttendanceBtn = document.getElementById('recordAttendanceBtn');
        const attendanceTableBody = document.getElementById('attendanceTableBody');
        const searchInput = document.getElementById('searchInput');
        const exportBtn = document.getElementById('exportBtn');
        const clearAllBtn = document.getElementById('clearAllBtn');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.querySelector('.sidebar');
        const trainingModal = document.getElementById('trainingModal');
        const closeTrainingModal = document.getElementById('closeTrainingModal');
        const closeTrainingModalBtn = document.getElementById('closeTrainingModalBtn');
        const trainingNeededCard = document.getElementById('trainingNeededCard');
        const skillUtilizationModal = document.getElementById('skillUtilizationModal');
        const closeSkillModal = document.getElementById('closeSkillModal');
        const closeSkillModalBtn = document.getElementById('closeSkillModalBtn');
        const kpiCards = document.querySelectorAll('.kpi-card');

        // Set today's date as default for attendance
        attendanceDate.valueAsDate = new Date();

        // Login Functionality
        loginBtn.addEventListener('click', () => {
            const username = usernameInput.value;
            const password = passwordInput.value;
            
            if (username === 'admin' && password === 'admin') {
                loginModal.classList.add('hidden');
                dashboard.classList.remove('hidden');
                loadData();
                initializeCharts();
                updateDashboard();
                showToast('Login successful!', 'success');
            } else {
                showToast('Invalid credentials. Use admin/admin', 'error');
            }
        });

        // Navigation
        sidebarItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const targetSection = item.getAttribute('data-section');
                
                // Update active state
                sidebarItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                
                // Show target section
                sections.forEach(section => section.classList.add('hidden'));
                document.getElementById(`${targetSection}-section`).classList.remove('hidden');
                
                // Close mobile sidebar if open
                if (window.innerWidth < 768) {
                    sidebar.classList.remove('open');
                }
            });
        });

        // KPI Card Interactions
        kpiCards.forEach(card => {
            card.addEventListener('click', () => {
                const targetSection = card.getAttribute('data-section');
                
                if (targetSection === 'employees') {
                    // Already handled by navigation
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    document.querySelector('[data-section="employees"]').classList.add('active');
                    sections.forEach(section => section.classList.add('hidden'));
                    document.getElementById('employees-section').classList.remove('hidden');
                } else if (targetSection === 'performance') {
                    // Already handled by navigation
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    document.querySelector('[data-section="performance"]').classList.add('active');
                    sections.forEach(section => section.classList.add('hidden'));
                    document.getElementById('performance-section').classList.remove('hidden');
                } else if (targetSection === 'skill-utilization') {
                    openSkillUtilizationModal();
                }
            });
        });

        // Training Needed Card Interaction
        trainingNeededCard.addEventListener('click', openTrainingModal);

        // Employee Management
        addEmployeeBtn.addEventListener('click', () => {
            employeeModal.classList.remove('hidden');
        });

        cancelEmployeeBtn.addEventListener('click', () => {
            employeeModal.classList.add('hidden');
            employeeForm.reset();
        });

        employeeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = document.getElementById('employeeName').value;
            const sector = document.getElementById('employeeSector').value;
            const workedHours = parseInt(document.getElementById('workedHours').value);
            const totalProjectHours = parseInt(document.getElementById('totalProjectHours').value);
            const projectCompleted = document.getElementById('projectCompleted').value;
            
            // Validation
            if (workedHours > totalProjectHours) {
                showToast('Worked hours cannot exceed total project hours', 'error');
                return;
            }
            
            // Calculate metrics automatically
            const presentDays = Math.floor(Math.random() * 20) + 1; // Simulated data
            const totalDays = 22; // Simulated data
            
            const consistency = Math.round((presentDays / totalDays) * 100);
            const efficiency = Math.round((workedHours / totalProjectHours) * 100);
            const quality = projectCompleted === 'Yes' ? 100 : 60;
            const performance = Math.round((0.4 * consistency) + (0.3 * efficiency) + (0.3 * quality));
            
            // Create employee object
            const employee = {
                id: Date.now().toString(),
                name,
                sector,
                workedHours,
                totalProjectHours,
                projectCompleted,
                consistency,
                efficiency,
                quality,
                performance,
                presentDays,
                totalDays
            };
            
            // Add to state
            dashboardState.employees.push(employee);
            
            // Save to localStorage
            saveData();
            
            // Update UI
            updateEmployeesTable();
            updateAttendanceDropdown();
            updateDashboard();
            
            // Close modal and reset form
            employeeModal.classList.add('hidden');
            employeeForm.reset();
            
            showToast('Employee added successfully!', 'success');
        });

        // Attendance Management
        recordAttendanceBtn.addEventListener('click', () => {
            const employeeId = attendanceEmployee.value;
            const date = attendanceDate.value;
            const status = attendanceStatus.value;
            
            if (!employeeId || !date) {
                showToast('Please select an employee and date', 'error');
                return;
            }
            
            // Create attendance record
            const attendanceRecord = {
                id: Date.now().toString(),
                employeeId,
                date,
                status
            };
            
            // Add to state
            dashboardState.attendance.push(attendanceRecord);
            
            // Save to localStorage
            saveData();
            
            // Update UI
            updateAttendanceTable();
            updateDashboard();
            
            // Reset form
            attendanceEmployee.value = '';
            attendanceDate.valueAsDate = new Date();
            attendanceStatus.value = 'Present';
            
            showToast('Attendance recorded successfully!', 'success');
        });

        // Search Functionality
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            filterEmployees(searchTerm);
        });

        // Export Data
        exportBtn.addEventListener('click', exportData);

        // Clear All Data
        clearAllBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                localStorage.removeItem('dashboardData');
                dashboardState.employees = [];
                dashboardState.attendance = [];
                updateEmployeesTable();
                updateAttendanceTable();
                updateDashboard();
                showToast('All data cleared', 'info');
            }
        });

        // Dark Mode Toggle
        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            dashboardState.darkMode = !dashboardState.darkMode;
            
            // Update charts for dark mode
            updateChartsForTheme();
            
            showToast(`Dark mode ${dashboardState.darkMode ? 'enabled' : 'disabled'}`, 'info');
        });

        // Mobile Menu Toggle
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Training Modal
        closeTrainingModal.addEventListener('click', () => {
            trainingModal.classList.add('hidden');
        });

        closeTrainingModalBtn.addEventListener('click', () => {
            trainingModal.classList.add('hidden');
        });

        // Skill Utilization Modal
        closeSkillModal.addEventListener('click', () => {
            skillUtilizationModal.classList.add('hidden');
        });

        closeSkillModalBtn.addEventListener('click', () => {
            skillUtilizationModal.classList.add('hidden');
        });

        // Data Management Functions
        function loadData() {
            const savedData = localStorage.getItem('dashboardData');
            if (savedData) {
                const data = JSON.parse(savedData);
                dashboardState.employees = data.employees || [];
                dashboardState.attendance = data.attendance || [];
            } else {
                // Load sample data if no saved data exists
                loadSampleData();
            }
        }

        function loadSampleData() {
            // Sample employees
            dashboardState.employees = [
                {
                    id: '1',
                    name: 'John Smith',
                    sector: 'Engineering',
                    workedHours: 40,
                    totalProjectHours: 45,
                    projectCompleted: 'Yes',
                    consistency: 95,
                    efficiency: 89,
                    quality: 100,
                    performance: 94,
                    presentDays: 21,
                    totalDays: 22
                },
                {
                    id: '2',
                    name: 'Sarah Johnson',
                    sector: 'Marketing',
                    workedHours: 35,
                    totalProjectHours: 40,
                    projectCompleted: 'Yes',
                    consistency: 86,
                    efficiency: 88,
                    quality: 100,
                    performance: 90,
                    presentDays: 19,
                    totalDays: 22
                },
                {
                    id: '3',
                    name: 'Michael Brown',
                    sector: 'Sales',
                    workedHours: 30,
                    totalProjectHours: 40,
                    projectCompleted: 'No',
                    consistency: 77,
                    efficiency: 75,
                    quality: 60,
                    performance: 71,
                    presentDays: 17,
                    totalDays: 22
                },
                {
                    id: '4',
                    name: 'Emily Davis',
                    sector: 'HR',
                    workedHours: 38,
                    totalProjectHours: 40,
                    projectCompleted: 'Yes',
                    consistency: 91,
                    efficiency: 95,
                    quality: 100,
                    performance: 95,
                    presentDays: 20,
                    totalDays: 22
                },
                {
                    id: '5',
                    name: 'David Wilson',
                    sector: 'Finance',
                    workedHours: 42,
                    totalProjectHours: 45,
                    projectCompleted: 'Yes',
                    consistency: 95,
                    efficiency: 93,
                    quality: 100,
                    performance: 96,
                    presentDays: 21,
                    totalDays: 22
                },
                {
                    id: '6',
                    name: 'Lisa Anderson',
                    sector: 'Operations',
                    workedHours: 32,
                    totalProjectHours: 40,
                    projectCompleted: 'No',
                    consistency: 73,
                    efficiency: 80,
                    quality: 60,
                    performance: 70,
                    presentDays: 16,
                    totalDays: 22
                }
            ];

            // Sample attendance records
            const today = new Date();
            const oneWeekAgo = new Date(today);
            oneWeekAgo.setDate(today.getDate() - 7);
            
            dashboardState.attendance = [];
            
            dashboardState.employees.forEach(employee => {
                for (let i = 0; i < 7; i++) {
                    const date = new Date(oneWeekAgo);
                    date.setDate(oneWeekAgo.getDate() + i);
                    
                    // Format date as YYYY-MM-DD
                    const dateStr = date.toISOString().split('T')[0];
                    
                    // Randomly determine attendance status (mostly present)
                    const status = Math.random() > 0.2 ? 'Present' : 'Absent';
                    
                    dashboardState.attendance.push({
                        id: `${employee.id}-${dateStr}`,
                        employeeId: employee.id,
                        date: dateStr,
                        status
                    });
                }
            });
            
            saveData();
        }

        function saveData() {
            const data = {
                employees: dashboardState.employees,
                attendance: dashboardState.attendance
            };
            localStorage.setItem('dashboardData', JSON.stringify(data));
        }

        function updateEmployeesTable() {
            employeesTableBody.innerHTML = '';
            
            if (dashboardState.employees.length === 0) {
                employeesTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-4 text-center text-gray-500">
                            No employees found. <a href="#" id="addFirstEmployee" class="text-green-500 hover:underline">Add the first employee</a>.
                        </td>
                    </tr>
                `;
                
                document.getElementById('addFirstEmployee').addEventListener('click', (e) => {
                    e.preventDefault();
                    addEmployeeBtn.click();
                });
                
                return;
            }
            
            dashboardState.employees.forEach(employee => {
                const row = document.createElement('tr');
                
                // Determine performance class
                let performanceClass = '';
                if (employee.performance <= 20) performanceClass = 'performance-0-20';
                else if (employee.performance <= 60) performanceClass = 'performance-21-60';
                else if (employee.performance <= 80) performanceClass = 'performance-61-80';
                else performanceClass = 'performance-81-100';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-800 font-bold">
                                    ${employee.name.split(' ').map(n => n[0]).join('')}
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${employee.name}</div>
                                <div class="text-sm text-gray-500">${employee.sector}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.consistency}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.efficiency}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.quality}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium ${performanceClass} px-2 py-1 rounded-full text-center">${employee.performance}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <button class="text-red-600 hover:text-red-900 delete-employee" data-id="${employee.id}">Delete</button>
                    </td>
                `;
                
                employeesTableBody.appendChild(row);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-employee').forEach(button => {
                button.addEventListener('click', (e) => {
                    const employeeId = e.target.getAttribute('data-id');
                    deleteEmployee(employeeId);
                });
            });
        }

        function deleteEmployee(employeeId) {
            if (confirm('Are you sure you want to delete this employee?')) {
                // Remove employee
                dashboardState.employees = dashboardState.employees.filter(emp => emp.id !== employeeId);
                
                // Remove related attendance records
                dashboardState.attendance = dashboardState.attendance.filter(record => record.employeeId !== employeeId);
                
                // Save data
                saveData();
                
                // Update UI
                updateEmployeesTable();
                updateAttendanceDropdown();
                updateAttendanceTable();
                updateDashboard();
                
                showToast('Employee deleted successfully', 'success');
            }
        }

        function updateAttendanceDropdown() {
            attendanceEmployee.innerHTML = '<option value="">Select Employee</option>';
            
            dashboardState.employees.forEach(employee => {
                const option = document.createElement('option');
                option.value = employee.id;
                option.textContent = employee.name;
                attendanceEmployee.appendChild(option);
            });
        }

        function updateAttendanceTable() {
            attendanceTableBody.innerHTML = '';
            
            if (dashboardState.attendance.length === 0) {
                attendanceTableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="px-6 py-4 text-center text-gray-500">
                            No attendance records found.
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Sort attendance by date (newest first)
            const sortedAttendance = [...dashboardState.attendance].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Show only the most recent 10 records
            const recentAttendance = sortedAttendance.slice(0, 10);
            
            recentAttendance.forEach(record => {
                const employee = dashboardState.employees.find(emp => emp.id === record.employeeId);
                if (!employee) return;
                
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${employee.name}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${formatDate(record.date)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="attendance-badge ${record.status === 'Present' ? 'attendance-present' : 'attendance-absent'}">
                            ${record.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <button class="text-red-600 hover:text-red-900 delete-attendance" data-id="${record.id}">Delete</button>
                    </td>
                `;
                
                attendanceTableBody.appendChild(row);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-attendance').forEach(button => {
                button.addEventListener('click', (e) => {
                    const attendanceId = e.target.getAttribute('data-id');
                    deleteAttendance(attendanceId);
                });
            });
        }

        function deleteAttendance(attendanceId) {
            dashboardState.attendance = dashboardState.attendance.filter(record => record.id !== attendanceId);
            saveData();
            updateAttendanceTable();
            updateDashboard();
            showToast('Attendance record deleted', 'success');
        }

        function filterEmployees(searchTerm) {
            const rows = employeesTableBody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const nameCell = row.querySelector('td:first-child');
                if (nameCell) {
                    const name = nameCell.textContent.toLowerCase();
                    if (name.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                }
            });
        }

        function updateDashboard() {
            // Update KPI cards
            document.getElementById('totalEmployees').textContent = dashboardState.employees.length;
            
            const avgPerformance = dashboardState.employees.length > 0 
                ? Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.performance, 0) / dashboardState.employees.length)
                : 0;
            document.getElementById('avgPerformance').textContent = `${avgPerformance}%`;
            
            const avgEfficiency = dashboardState.employees.length > 0 
                ? Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.efficiency, 0) / dashboardState.employees.length)
                : 0;
            document.getElementById('skillUtilization').textContent = `${avgEfficiency}%`;
            
            const trainingNeeded = dashboardState.employees.filter(emp => emp.performance < 60).length;
            document.getElementById('trainingNeeded').textContent = trainingNeeded;
            
            // Update charts
            updateCharts();
            
            // Update sector performance
            updateSectorPerformance();
            
            // Update company strength
            updateCompanyStrength();
        }

        function updateSectorPerformance() {
            const sectorBoxesContainer = document.getElementById('sectorBoxesContainer');
            sectorBoxesContainer.innerHTML = '';
            
            const sectorPerformance = {};
            
            // Calculate average performance per sector
            dashboardState.employees.forEach(employee => {
                if (!sectorPerformance[employee.sector]) {
                    sectorPerformance[employee.sector] = {
                        total: 0,
                        count: 0
                    };
                }
                
                sectorPerformance[employee.sector].total += employee.performance;
                sectorPerformance[employee.sector].count++;
            });
            
            // Create sector boxes
            Object.keys(sectorPerformance).forEach(sector => {
                const avgPerformance = Math.round(sectorPerformance[sector].total / sectorPerformance[sector].count);
                
                const box = document.createElement('div');
                box.className = 'bg-white rounded-lg shadow p-6 cursor-pointer transition-transform duration-300 hover:scale-105';
                box.setAttribute('data-sector', sector);
                
                // Determine performance class
                let performanceClass = '';
                if (avgPerformance <= 20) performanceClass = 'performance-0-20';
                else if (avgPerformance <= 60) performanceClass = 'performance-21-60';
                else if (avgPerformance <= 80) performanceClass = 'performance-61-80';
                else performanceClass = 'performance-81-100';
                
                box.innerHTML = `
                    <h3 class="text-lg font-medium text-gray-900 mb-2">${sector}</h3>
                    <div class="flex items-center justify-between">
                        <div class="text-3xl font-bold text-gray-900">${avgPerformance}%</div>
                        <div class="text-sm ${performanceClass} px-2 py-1 rounded-full">${sectorPerformance[sector].count} employees</div>
                    </div>
                `;
                
                box.addEventListener('click', () => {
                    showSectorDetail(sector);
                });
                
                sectorBoxesContainer.appendChild(box);
            });
        }

        function showSectorDetail(sector) {
            const sectorDetail = document.getElementById('sector-detail');
            const sectorDetailTitle = document.getElementById('sectorDetailTitle');
            const sectorSummary = document.getElementById('sectorSummary');
            const sectorEmployeesTableBody = document.getElementById('sectorEmployeesTableBody');
            
            // Show sector detail section
            document.getElementById('sectors-section').querySelectorAll('> *').forEach(el => {
                if (el.id !== 'sector-detail') {
                    el.classList.add('hidden');
                }
            });
            sectorDetail.classList.remove('hidden');
            
            // Update sector detail content
            sectorDetailTitle.textContent = `${sector} Performance`;
            
            const sectorEmployees = dashboardState.employees.filter(emp => emp.sector === sector);
            const avgPerformance = Math.round(sectorEmployees.reduce((sum, emp) => sum + emp.performance, 0) / sectorEmployees.length);
            const avgConsistency = Math.round(sectorEmployees.reduce((sum, emp) => sum + emp.consistency, 0) / sectorEmployees.length);
            const avgEfficiency = Math.round(sectorEmployees.reduce((sum, emp) => sum + emp.efficiency, 0) / sectorEmployees.length);
            const avgQuality = Math.round(sectorEmployees.reduce((sum, emp) => sum + emp.quality, 0) / sectorEmployees.length);
            
            sectorSummary.textContent = `The ${sector} sector has ${sectorEmployees.length} employees with an average performance of ${avgPerformance}%. Average consistency is ${avgConsistency}%, efficiency is ${avgEfficiency}%, and quality is ${avgQuality}%.`;
            
            // Update sector employees table
            sectorEmployeesTableBody.innerHTML = '';
            
            sectorEmployees.forEach(employee => {
                const row = document.createElement('tr');
                
                // Determine performance class
                let performanceClass = '';
                if (employee.performance <= 20) performanceClass = 'performance-0-20';
                else if (employee.performance <= 60) performanceClass = 'performance-21-60';
                else if (employee.performance <= 80) performanceClass = 'performance-61-80';
                else performanceClass = 'performance-81-100';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${employee.name}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.consistency}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.efficiency}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${employee.quality}%</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium ${performanceClass} px-2 py-1 rounded-full text-center">${employee.performance}%</div>
                    </td>
                `;
                
                sectorEmployeesTableBody.appendChild(row);
            });
            
            // Update sector detail chart
            updateSectorDetailChart(sector, sectorEmployees);
        }

        function updateCompanyStrength() {
            if (dashboardState.employees.length === 0) {
                document.getElementById('mostConsistent').textContent = '-';
                document.getElementById('mostConsistentValue').textContent = '0%';
                document.getElementById('mostEfficient').textContent = '-';
                document.getElementById('mostEfficientValue').textContent = '0%';
                document.getElementById('highestQuality').textContent = '-';
                document.getElementById('highestQualityValue').textContent = '0%';
                document.getElementById('topOverall').textContent = '-';
                document.getElementById('topOverallValue').textContent = '0%';
                
                document.getElementById('strengthsList').innerHTML = '<li>No data available</li>';
                document.getElementById('weaknessesList').innerHTML = '<li>No data available</li>';
                return;
            }
            
            // Find top performers
            const mostConsistent = dashboardState.employees.reduce((prev, current) => 
                (prev.consistency > current.consistency) ? prev : current
            );
            const mostEfficient = dashboardState.employees.reduce((prev, current) => 
                (prev.efficiency > current.efficiency) ? prev : current
            );
            const highestQuality = dashboardState.employees.reduce((prev, current) => 
                (prev.quality > current.quality) ? prev : current
            );
            const topOverall = dashboardState.employees.reduce((prev, current) => 
                (prev.performance > current.performance) ? prev : current
            );
            
            // Update UI
            document.getElementById('mostConsistent').textContent = mostConsistent.name.split(' ')[0];
            document.getElementById('mostConsistentValue').textContent = `${mostConsistent.consistency}%`;
            document.getElementById('mostEfficient').textContent = mostEfficient.name.split(' ')[0];
            document.getElementById('mostEfficientValue').textContent = `${mostEfficient.efficiency}%`;
            document.getElementById('highestQuality').textContent = highestQuality.name.split(' ')[0];
            document.getElementById('highestQualityValue').textContent = `${highestQuality.quality}%`;
            document.getElementById('topOverall').textContent = topOverall.name.split(' ')[0];
            document.getElementById('topOverallValue').textContent = `${topOverall.performance}%`;
            
            // Calculate strengths and weaknesses
            const avgConsistency = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.consistency, 0) / dashboardState.employees.length);
            const avgEfficiency = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.efficiency, 0) / dashboardState.employees.length);
            const avgQuality = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.quality, 0) / dashboardState.employees.length);
            
            const strengthsList = document.getElementById('strengthsList');
            const weaknessesList = document.getElementById('weaknessesList');
            
            strengthsList.innerHTML = '';
            weaknessesList.innerHTML = '';
            
            // Identify strengths (metrics above 80%)
            if (avgConsistency >= 80) {
                const li = document.createElement('li');
                li.textContent = `High consistency across employees (${avgConsistency}%)`;
                strengthsList.appendChild(li);
            }
            
            if (avgEfficiency >= 80) {
                const li = document.createElement('li');
                li.textContent = `Strong efficiency in work processes (${avgEfficiency}%)`;
                strengthsList.appendChild(li);
            }
            
            if (avgQuality >= 80) {
                const li = document.createElement('li');
                li.textContent = `Excellent quality of work delivered (${avgQuality}%)`;
                strengthsList.appendChild(li);
            }
            
            if (strengthsList.children.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'No significant strengths identified';
                strengthsList.appendChild(li);
            }
            
            // Identify weaknesses (metrics below 70%)
            if (avgConsistency < 70) {
                const li = document.createElement('li');
                li.textContent = `Low consistency in attendance and work habits (${avgConsistency}%)`;
                weaknessesList.appendChild(li);
            }
            
            if (avgEfficiency < 70) {
                const li = document.createElement('li');
                li.textContent = `Inefficient work processes (${avgEfficiency}%)`;
                weaknessesList.appendChild(li);
            }
            
            if (avgQuality < 70) {
                const li = document.createElement('li');
                li.textContent = `Quality issues in deliverables (${avgQuality}%)`;
                weaknessesList.appendChild(li);
            }
            
            // Check for employees needing training
            const lowPerformers = dashboardState.employees.filter(emp => emp.performance < 60);
            if (lowPerformers.length > 0) {
                const li = document.createElement('li');
                li.textContent = `${lowPerformers.length} employees need performance improvement training`;
                weaknessesList.appendChild(li);
            }
            
            if (weaknessesList.children.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'No significant weaknesses identified';
                weaknessesList.appendChild(li);
            }
        }

        function openTrainingModal() {
            const trainingList = document.getElementById('trainingList');
            trainingList.innerHTML = '';
            
            const lowPerformers = dashboardState.employees.filter(emp => emp.performance < 60);
            
            if (lowPerformers.length === 0) {
                trainingList.innerHTML = `
                    <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-green-700">
                                    <span class="font-medium">Great news!</span> All employees are performing at acceptable levels (60% or higher).
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                lowPerformers.forEach(employee => {
                    const employeeCard = document.createElement('div');
                    employeeCard.className = 'bg-white border border-gray-200 rounded-lg p-4 mb-4';
                    
                    // Determine areas for improvement
                    const improvementAreas = [];
                    if (employee.consistency < 70) improvementAreas.push('Consistency');
                    if (employee.efficiency < 70) improvementAreas.push('Efficiency');
                    if (employee.quality < 70) improvementAreas.push('Quality');
                    
                    employeeCard.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="text-lg font-medium text-gray-900">${employee.name}</h4>
                                <p class="text-sm text-gray-600">${employee.sector} • Performance: ${employee.performance}%</p>
                                <div class="mt-2">
                                    <span class="text-sm font-medium text-gray-700">Areas for improvement:</span>
                                    <span class="text-sm text-gray-600 ml-2">${improvementAreas.join(', ') || 'General performance'}</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-red-600 font-bold">${employee.performance}%</div>
                                <div class="text-xs text-gray-500">Performance</div>
                            </div>
                        </div>
                        <div class="mt-3 grid grid-cols-3 gap-2 text-center">
                            <div>
                                <div class="text-sm ${employee.consistency < 70 ? 'text-red-600' : 'text-gray-600'}">${employee.consistency}%</div>
                                <div class="text-xs text-gray-500">Consistency</div>
                            </div>
                            <div>
                                <div class="text-sm ${employee.efficiency < 70 ? 'text-red-600' : 'text-gray-600'}">${employee.efficiency}%</div>
                                <div class="text-xs text-gray-500">Efficiency</div>
                            </div>
                            <div>
                                <div class="text-sm ${employee.quality < 70 ? 'text-red-600' : 'text-gray-600'}">${employee.quality}%</div>
                                <div class="text-xs text-gray-500">Quality</div>
                            </div>
                        </div>
                    `;
                    
                    trainingList.appendChild(employeeCard);
                });
            }
            
            trainingModal.classList.remove('hidden');
        }

        function openSkillUtilizationModal() {
            // Update efficiency distribution chart
            updateEfficiencyDistributionChart();
            
            // Update sector efficiency chart
            updateSectorEfficiencyChart();
            
            // Update recommendations
            updateSkillRecommendations();
            
            skillUtilizationModal.classList.remove('hidden');
        }

        function updateSkillRecommendations() {
            const skillRecommendations = document.getElementById('skillRecommendations');
            skillRecommendations.innerHTML = '';
            
            if (dashboardState.employees.length === 0) {
                skillRecommendations.innerHTML = '<p>No employee data available for analysis.</p>';
                return;
            }
            
            const avgEfficiency = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.efficiency, 0) / dashboardState.employees.length);
            const lowEfficiencyEmployees = dashboardState.employees.filter(emp => emp.efficiency < 70);
            
            let recommendationsHTML = '';
            
            if (avgEfficiency >= 80) {
                recommendationsHTML += `
                    <p class="mb-3">Your organization demonstrates <strong>strong skill utilization</strong> with an average efficiency of ${avgEfficiency}%.</p>
                    <p class="mb-3">Consider these actions to maintain and improve:</p>
                    <ul class="list-disc pl-5 mb-3">
                        <li>Implement cross-training programs to expand employee skill sets</li>
                        <li>Create mentorship opportunities for high-performing employees</li>
                        <li>Explore advanced tools and technologies to further optimize workflows</li>
                    </ul>
                `;
            } else if (avgEfficiency >= 70) {
                recommendationsHTML += `
                    <p class="mb-3">Your organization demonstrates <strong>moderate skill utilization</strong> with an average efficiency of ${avgEfficiency}%.</p>
                    <p class="mb-3">Consider these actions to improve:</p>
                    <ul class="list-disc pl-5 mb-3">
                        <li>Provide targeted training for employees with efficiency below 70%</li>
                        <li>Review and optimize workflow processes in low-performing sectors</li>
                        <li>Implement performance tracking and feedback systems</li>
                    </ul>
                `;
            } else {
                recommendationsHTML += `
                    <p class="mb-3">Your organization demonstrates <strong>low skill utilization</strong> with an average efficiency of ${avgEfficiency}%.</p>
                    <p class="mb-3">Immediate actions needed:</p>
                    <ul class="list-disc pl-5 mb-3">
                        <li>Conduct skill gap analysis across all departments</li>
                        <li>Implement comprehensive training programs for ${lowEfficiencyEmployees.length} employees with efficiency below 70%</li>
                        <li>Review resource allocation and project assignments</li>
                        <li>Consider process re-engineering to eliminate bottlenecks</li>
                    </ul>
                `;
            }
            
            // Add sector-specific recommendations
            const sectorEfficiency = {};
            dashboardState.employees.forEach(employee => {
                if (!sectorEfficiency[employee.sector]) {
                    sectorEfficiency[employee.sector] = {
                        total: 0,
                        count: 0
                    };
                }
                sectorEfficiency[employee.sector].total += employee.efficiency;
                sectorEfficiency[employee.sector].count++;
            });
            
            const lowSectors = Object.keys(sectorEfficiency).filter(sector => 
                sectorEfficiency[sector].total / sectorEfficiency[sector].count < 70
            );
            
            if (lowSectors.length > 0) {
                recommendationsHTML += `
                    <p class="mb-3"><strong>Sector-specific concerns:</strong> The following sectors show below-average efficiency and may need targeted interventions:</p>
                    <ul class="list-disc pl-5">
                        ${lowSectors.map(sector => `<li>${sector} (${Math.round(sectorEfficiency[sector].total / sectorEfficiency[sector].count)}%)</li>`).join('')}
                    </ul>
                `;
            }
            
            skillRecommendations.innerHTML = recommendationsHTML;
        }

        function exportData() {
            if (dashboardState.employees.length === 0) {
                showToast('No data to export', 'error');
                return;
            }
            
            // Create CSV content
            let csvContent = 'Name,Sector,Worked Hours,Total Project Hours,Project Completed,Consistency %,Efficiency %,Quality %,Performance %,Attendance %\n';
            
            dashboardState.employees.forEach(employee => {
                const attendancePercentage = Math.round((employee.presentDays / employee.totalDays) * 100);
                csvContent += `"${employee.name}",${employee.sector},${employee.workedHours},${employee.totalProjectHours},${employee.projectCompleted},${employee.consistency},${employee.efficiency},${employee.quality},${employee.performance},${attendancePercentage}\n`;
            });
            
            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'workforce_performance_data.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Data exported successfully', 'success');
        }

        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        function showToast(message, type) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            toastContainer.appendChild(toast);
            
            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Hide and remove toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toastContainer.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Chart Management
        function initializeCharts() {
            // Sector Performance Chart
            const sectorPerformanceCtx = document.getElementById('sectorPerformanceChart').getContext('2d');
            dashboardState.charts.sectorPerformance = new Chart(sectorPerformanceCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Average Performance (%)',
                        data: [],
                        backgroundColor: 'rgba(34, 197, 94, 0.7)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Performance: ${context.parsed.y}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Productivity Trend Chart
            const productivityTrendCtx = document.getElementById('productivityTrendChart').getContext('2d');
            dashboardState.charts.productivityTrend = new Chart(productivityTrendCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Productivity Trend',
                        data: [],
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Productivity: ${context.parsed.y}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Skill Distribution Chart
            const skillDistributionCtx = document.getElementById('skillDistributionChart').getContext('2d');
            dashboardState.charts.skillDistribution = new Chart(skillDistributionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Low (0-60%)', 'Medium (61-80%)', 'High (81-100%)'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(34, 197, 94, 0.7)'
                        ],
                        borderColor: [
                            'rgba(239, 68, 68, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(34, 197, 94, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Performance Distribution Chart
            const performanceDistributionCtx = document.getElementById('performanceDistributionChart').getContext('2d');
            dashboardState.charts.performanceDistribution = new Chart(performanceDistributionCtx, {
                type: 'bar',
                data: {
                    labels: ['0-20%', '21-40%', '41-60%', '61-80%', '81-100%'],
                    datasets: [{
                        label: 'Number of Employees',
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(139, 92, 246, 0.7)',
                        borderColor: 'rgba(139, 92, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Attendance vs Performance Chart
            const attendancePerformanceCtx = document.getElementById('attendancePerformanceChart').getContext('2d');
            dashboardState.charts.attendancePerformance = new Chart(attendancePerformanceCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Employees',
                        data: [],
                        backgroundColor: 'rgba(59, 130, 246, 0.7)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Attendance Rate (%)'
                            },
                            min: 0,
                            max: 100
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Performance (%)'
                            },
                            min: 0,
                            max: 100
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Attendance: ${context.parsed.x}%, Performance: ${context.parsed.y}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Performance Trends Chart
            const performanceTrendsCtx = document.getElementById('performanceTrendsChart').getContext('2d');
            dashboardState.charts.performanceTrends = new Chart(performanceTrendsCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Sector Detail Chart
            const sectorDetailCtx = document.getElementById('sectorDetailChart').getContext('2d');
            dashboardState.charts.sectorDetail = new Chart(sectorDetailCtx, {
                type: 'radar',
                data: {
                    labels: ['Consistency', 'Efficiency', 'Quality', 'Performance'],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Efficiency Distribution Chart
            const efficiencyDistributionCtx = document.getElementById('efficiencyDistributionChart').getContext('2d');
            dashboardState.charts.efficiencyDistribution = new Chart(efficiencyDistributionCtx, {
                type: 'bar',
                data: {
                    labels: ['0-20%', '21-40%', '41-60%', '61-80%', '81-100%'],
                    datasets: [{
                        label: 'Number of Employees',
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(245, 158, 11, 0.7)',
                        borderColor: 'rgba(245, 158, 11, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            // Sector Efficiency Chart
            const sectorEfficiencyCtx = document.getElementById('sectorEfficiencyChart').getContext('2d');
            dashboardState.charts.sectorEfficiency = new Chart(sectorEfficiencyCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Average Efficiency (%)',
                        data: [],
                        backgroundColor: 'rgba(139, 92, 246, 0.7)',
                        borderColor: 'rgba(139, 92, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateCharts() {
            updateSectorPerformanceChart();
            updateProductivityTrendChart();
            updateSkillDistributionChart();
            updatePerformanceDistributionChart();
            updateAttendancePerformanceChart();
            updatePerformanceTrendsChart();
        }

        function updateSectorPerformanceChart() {
            const sectorPerformance = {};
            
            // Calculate average performance per sector
            dashboardState.employees.forEach(employee => {
                if (!sectorPerformance[employee.sector]) {
                    sectorPerformance[employee.sector] = {
                        total: 0,
                        count: 0
                    };
                }
                
                sectorPerformance[employee.sector].total += employee.performance;
                sectorPerformance[employee.sector].count++;
            });
            
            const labels = Object.keys(sectorPerformance);
            const data = labels.map(sector => 
                Math.round(sectorPerformance[sector].total / sectorPerformance[sector].count)
            );
            
            dashboardState.charts.sectorPerformance.data.labels = labels;
            dashboardState.charts.sectorPerformance.data.datasets[0].data = data;
            dashboardState.charts.sectorPerformance.update();
            
            // Update summary
            const sectorPerformanceSummary = document.getElementById('sectorPerformanceSummary');
            if (labels.length > 0) {
                const topSector = labels.reduce((a, b) => 
                    sectorPerformance[a].total / sectorPerformance[a].count > sectorPerformance[b].total / sectorPerformance[b].count ? a : b
                );
                const topSectorAvg = Math.round(sectorPerformance[topSector].total / sectorPerformance[topSector].count);
                sectorPerformanceSummary.textContent = `Top performing sector: ${topSector} (${topSectorAvg}% average performance)`;
            } else {
                sectorPerformanceSummary.textContent = 'No sector data available';
            }
        }

        function updateProductivityTrendChart() {
            // Generate productivity trend data (simulated)
            const labels = [];
            const data = [];
            
            const today = new Date();
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
                
                // Simulate productivity data
                if (dashboardState.employees.length > 0) {
                    // Base productivity on employee performance with some variation
                    const baseProductivity = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.performance, 0) / dashboardState.employees.length);
                    const variation = Math.floor(Math.random() * 20) - 10; // -10 to +10
                    data.push(Math.max(0, Math.min(100, baseProductivity + variation)));
                } else {
                    data.push(0);
                }
            }
            
            dashboardState.charts.productivityTrend.data.labels = labels;
            dashboardState.charts.productivityTrend.data.datasets[0].data = data;
            dashboardState.charts.productivityTrend.update();
            
            // Update summary
            const productivityTrendSummary = document.getElementById('productivityTrendSummary');
            if (data.length > 0) {
                const todayProductivity = data[data.length - 1];
                const yesterdayProductivity = data[data.length - 2] || todayProductivity;
                const change = todayProductivity - yesterdayProductivity;
                const trend = change > 0 ? 'up' : (change < 0 ? 'down' : 'stable');
                
                productivityTrendSummary.textContent = `Today's productivity: ${todayProductivity}% (${trend} from yesterday)`;
            } else {
                productivityTrendSummary.textContent = 'No productivity data available';
            }
        }

        function updateSkillDistributionChart() {
            const low = dashboardState.employees.filter(emp => emp.performance <= 60).length;
            const medium = dashboardState.employees.filter(emp => emp.performance > 60 && emp.performance <= 80).length;
            const high = dashboardState.employees.filter(emp => emp.performance > 80).length;
            
            dashboardState.charts.skillDistribution.data.datasets[0].data = [low, medium, high];
            dashboardState.charts.skillDistribution.update();
            
            // Update summary
            const skillDistributionSummary = document.getElementById('skillDistributionSummary');
            if (dashboardState.employees.length > 0) {
                const highPercentage = Math.round((high / dashboardState.employees.length) * 100);
                skillDistributionSummary.textContent = `${highPercentage}% of employees are high performers (above 80%)`;
            } else {
                skillDistributionSummary.textContent = 'No employee data available';
            }
        }

        function updatePerformanceDistributionChart() {
            const ranges = [
                dashboardState.employees.filter(emp => emp.performance <= 20).length,
                dashboardState.employees.filter(emp => emp.performance > 20 && emp.performance <= 40).length,
                dashboardState.employees.filter(emp => emp.performance > 40 && emp.performance <= 60).length,
                dashboardState.employees.filter(emp => emp.performance > 60 && emp.performance <= 80).length,
                dashboardState.employees.filter(emp => emp.performance > 80).length
            ];
            
            dashboardState.charts.performanceDistribution.data.datasets[0].data = ranges;
            dashboardState.charts.performanceDistribution.update();
            
            // Update summary
            const performanceDistributionSummary = document.getElementById('performanceDistributionSummary');
            if (dashboardState.employees.length > 0) {
                const avgPerformance = Math.round(dashboardState.employees.reduce((sum, emp) => sum + emp.performance, 0) / dashboardState.employees.length);
                performanceDistributionSummary.textContent = `Average performance: ${avgPerformance}%`;
            } else {
                performanceDistributionSummary.textContent = 'No performance data available';
            }
        }

        function updateAttendancePerformanceChart() {
            const data = dashboardState.employees.map(employee => {
                const attendanceRate = Math.round((employee.presentDays / employee.totalDays) * 100);
                return {
                    x: attendanceRate,
                    y: employee.performance
                };
            });
            
            dashboardState.charts.attendancePerformance.data.datasets[0].data = data;
            dashboardState.charts.attendancePerformance.update();
            
            // Update summary
            const attendancePerformanceSummary = document.getElementById('attendancePerformanceSummary');
            if (data.length > 0) {
                // Calculate correlation (simplified)
                const avgAttendance = data.reduce((sum, point) => sum + point.x, 0) / data.length;
                const avgPerformance = data.reduce((sum, point) => sum + point.y, 0) / data.length;
                
                let correlation = 'weak';
                if (Math.abs(avgAttendance - avgPerformance) < 10) {
                    correlation = 'strong';
                } else if (Math.abs(avgAttendance - avgPerformance) < 20) {
                    correlation = 'moderate';
                }
                
                attendancePerformanceSummary.textContent = `Attendance and performance show a ${correlation} positive correlation`;
            } else {
                attendancePerformanceSummary.textContent = 'No data available for correlation analysis';
            }
        }

        function updatePerformanceTrendsChart() {
            // Generate performance trends by sector (simulated)
            const sectors = [...new Set(dashboardState.employees.map(emp => emp.sector))];
            const labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            
            const datasets = sectors.map(sector => {
                const sectorEmployees = dashboardState.employees.filter(emp => emp.sector === sector);
                const basePerformance = sectorEmployees.length > 0 
                    ? Math.round(sectorEmployees.reduce((sum, emp) => sum + emp.performance, 0) / sectorEmployees.length)
                    : 50;
                
                // Generate trend data with some variation
                const data = labels.map(() => {
                    const variation = Math.floor(Math.random() * 20) - 10;
                    return Math.max(0, Math.min(100, basePerformance + variation));
                });
                
                // Generate random color
                const hue = Math.floor(Math.random() * 360);
                
                return {
                    label: sector,
                    data: data,
                    borderColor: `hsl(${hue}, 70%, 50%)`,
                    backgroundColor: `hsla(${hue}, 70%, 50%, 0.1)`,
                    tension: 0.4,
                    fill: false
                };
            });
            
            dashboardState.charts.performanceTrends.data.labels = labels;
            dashboardState.charts.performanceTrends.data.datasets = datasets;
            dashboardState.charts.performanceTrends.update();
            
            // Update summary
            const performanceTrendsSummary = document.getElementById('performanceTrendsSummary');
            if (sectors.length > 0) {
                performanceTrendsSummary.textContent = `Tracking performance trends across ${sectors.length} sectors`;
            } else {
                performanceTrendsSummary.textContent = 'No sector data available for trend analysis';
            }
        }

        function updateSectorDetailChart(sector, sectorEmployees) {
            const datasets = sectorEmployees.map(employee => {
                // Generate random color
                const hue = Math.floor(Math.random() * 360);
                
                return {
                    label: employee.name,
                    data: [employee.consistency, employee.efficiency, employee.quality, employee.performance],
                    backgroundColor: `hsla(${hue}, 70%, 50%, 0.2)`,
                    borderColor: `hsl(${hue}, 70%, 50%)`,
                    borderWidth: 1
                };
            });
            
            dashboardState.charts.sectorDetail.data.datasets = datasets;
            dashboardState.charts.sectorDetail.update();
        }

        function updateEfficiencyDistributionChart() {
            const ranges = [
                dashboardState.employees.filter(emp => emp.efficiency <= 20).length,
                dashboardState.employees.filter(emp => emp.efficiency > 20 && emp.efficiency <= 40).length,
                dashboardState.employees.filter(emp => emp.efficiency > 40 && emp.efficiency <= 60).length,
                dashboardState.employees.filter(emp => emp.efficiency > 60 && emp.efficiency <= 80).length,
                dashboardState.employees.filter(emp => emp.efficiency > 80).length
            ];
            
            dashboardState.charts.efficiencyDistribution.data.datasets[0].data = ranges;
            dashboardState.charts.efficiencyDistribution.update();
        }

        function updateSectorEfficiencyChart() {
            const sectorEfficiency = {};
            
            // Calculate average efficiency per sector
            dashboardState.employees.forEach(employee => {
                if (!sectorEfficiency[employee.sector]) {
                    sectorEfficiency[employee.sector] = {
                        total: 0,
                        count: 0
                    };
                }
                
                sectorEfficiency[employee.sector].total += employee.efficiency;
                sectorEfficiency[employee.sector].count++;
            });
            
            const labels = Object.keys(sectorEfficiency);
            const data = labels.map(sector => 
                Math.round(sectorEfficiency[sector].total / sectorEfficiency[sector].count)
            );
            
            dashboardState.charts.sectorEfficiency.data.labels = labels;
            dashboardState.charts.sectorEfficiency.data.datasets[0].data = data;
            dashboardState.charts.sectorEfficiency.update();
        }

        function updateChartsForTheme() {
            // This function would update chart colors for dark mode
            // For simplicity, we're just updating the background color of chart containers
            const chartContainers = document.querySelectorAll('.bg-white');
            
            if (dashboardState.darkMode) {
                chartContainers.forEach(container => {
                    container.classList.remove('bg-white');
                    container.classList.add('bg-gray-700');
                });
            } else {
                chartContainers.forEach(container => {
                    container.classList.remove('bg-gray-700');
                    container.classList.add('bg-white');
                });
            }
            
            // Update all charts
            Object.values(dashboardState.charts).forEach(chart => {
                chart.update();
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            // Set default date for attendance
            const today = new Date();
            attendanceDate.valueAsDate = today;
            
            // Check if user is already logged in (for demo purposes)
            const savedLogin = localStorage.getItem('dashboardLogin');
            if (savedLogin === 'true') {
                loginModal.classList.add('hidden');
                dashboard.classList.remove('hidden');
                loadData();
                initializeCharts();
                updateDashboard();
            }
            
            // Save login state for demo purposes
            loginBtn.addEventListener('click', () => {
                localStorage.setItem('dashboardLogin', 'true');
            });
        });
    </script>
</body>
</html>